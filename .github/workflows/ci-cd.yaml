name: SQL Lint and Pattern Check
on:
  push:
 
jobs:
  lint:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3
       
      - name: Set up Python & Install SQLFluff + Plugin
        run: |
          python -m pip install --upgrade pip
          pip install sqlfluff

      - name: Lint SQL files
        run: |
          echo "üìÑ Linting SQL files..."
          sqlfluff lint sql/ --dialect mysql

       # sqlfluff lint sql/ --dialect snowflake
        # sqlfluff lint sql/ --dialect snowflake_with_iceberg
          

      # - name: Search for environment patterns
      #   run: |
      #     if grep -rnw '.' -e '@dev@' -e '@test@' -e '@prod@'; then
      #       echo "‚ùå Environment pattern found. Failing the workflow."
      #       exit 1
      #     else
      #       echo "‚úÖ No environment patterns found."
      #     fi
